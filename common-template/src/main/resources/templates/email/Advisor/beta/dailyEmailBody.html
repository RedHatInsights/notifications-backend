{@boolean renderSection1=true}
{@boolean renderButtonSection1=true}
{#include email/Common/insightsEmailBodyLightV2}
{#content-title-section1}
    Recommendation{#if action.context.advisor.total_recommendation > 1}s{/if}
{/content-title-section1}
{#content-title-right-part-section1}
    {action.context.advisor.total_recommendation}
{/content-title-right-part-section1}
{#content-body-section1}
<p style="{body-section-p-style}">{action.context.advisor.total_incident} total incident{#if action.context.advisor.total_incident > 1}s{/if}<p>

<table style="width: 100%; border: 0">
{#if action.context.advisor.new_recommendations.orEmpty.size > 0}
    <tr><td>
    <table style="border: solid 1px #b8bbbe; border-radius: 16px; padding: 0 8px 0 8px; width: 100%;"><tr><td>
        <table style="{body-section-table-style}">
        <thead>
            <tr>
                <th style="{body-section-table-th-style} width: 16px;"></th>
                <th style="{body-section-table-th-style}" class="recommendation-col">New Recommendation{#if action.context.advisor.new_recommendations.orEmpty.size > 1}s{/if}</th>
                <th style="{body-section-table-th-style}">Total Risk</th>
                <th style="{body-section-table-th-style}">Systems</th>
            </tr>
            </thead>
            <tbody style="{body-section-table-tbody-style}">
            {#for rec in action.context.advisor.new_recommendations.keySet()}
            <tr>
                {#let isIncident = action.context.advisor.new_recommendations.get(rec).has_incident.or("false")}
                    {#if isIncident && (true == isIncident || "true" == isIncident)}
                        <td style="{body-section-table-td-style} width: 16px;">
                            <img src="https://console.redhat.com/apps/frontend-assets/email-assets/img_incident.png" title="Incident" alt="Incident" border="0" width="16" />
                        </td>
                    {#else}
                        <td style="{body-section-table-td-style} width: 16px;"></td>
                    {/if}
                {/let}
                <td style="{body-section-table-td-style}">
                    <a style="{body-section-table-td-a-style}" target="_blank" href="{environment.url}/insights/advisor/recommendations/{rec}?{query_params}">{action.context.advisor.new_recommendations.get(rec).rule_description}</a>
                </td>
                <td style="{body-section-table-td-style}">
                    {#switch action.context.advisor.new_recommendations.get(rec).total_risk}
                    {#case "1"}<img src="https://console.redhat.com/apps/frontend-assets/email-assets/img_low_v2.png" alt="Low severity" width="55" border="0">
                    {#case "2"}<img src="https://console.redhat.com/apps/frontend-assets/email-assets/img_moderate_v2.png" alt="Moderate severity" width="85" border="0">
                    {#case "3"}<img src="https://console.redhat.com/apps/frontend-assets/email-assets/img_important_v2.png" alt="Important severity" width="86" border="0">
                    {#case "4"}<img src="https://console.redhat.com/apps/frontend-assets/email-assets/img_critical_v2.png" alt="Critical severity" width="70" border="0">
                    {/switch}
                </td>
                <td style="{body-section-table-td-style}">{action.context.advisor.new_recommendations.get(rec).systems}</td>
            </tr>
            {/for}
            </tbody>
        </table>
    </td></tr></table>
    </td></tr>
    {#if action.context.advisor.deactivated_recommendations.orEmpty.size > 0 || action.context.advisor.resolved_recommendations.orEmpty.size > 0}
    <tr><td style="line-height: 24px">&#xA0;</td></tr>
    {/if}
{/if}
{#if action.context.advisor.resolved_recommendations.orEmpty.size > 0}
    <tr><td>
    <table style="border: solid 1px #b8bbbe; border-radius: 16px; padding: 0 8px 0px 8px; width: 100%;"><tr><td>
        <table style="{body-section-table-style}">
            <thead>
            <tr>
              <th style="{body-section-table-th-style} width: 16px; padding: 10px 0 10px 10px !important;"></th>
              <th style="{body-section-table-th-style}" class="recommendation-col">Resolved Recommendation{#if action.context.advisor.resolved_recommendations.orEmpty.size > 1}s{/if}</th>
              <th style="{body-section-table-th-style}">Total Risk</th>
              <th style="{body-section-table-th-style}">Systems</th>
            </tr>
            </thead>
            <tbody style="{body-section-table-tbody-style}">
            {#for rec in action.context.advisor.resolved_recommendations.keySet()}
              <tr>
                {#let isIncident = action.context.advisor.resolved_recommendations.get(rec).has_incident.or("false")}
                    {#if isIncident && (true == isIncident || "true" == isIncident)}
                        <td style="{body-section-table-td-style} width: 16px; padding: 10px 0 10px 10px !important;">
                            <img src="https://console.redhat.com/apps/frontend-assets/email-assets/img_incident.png" title="Incident" alt="Incident" width="16"/>
                        </td>
                    {#else}
                            <td style="{body-section-table-td-style} width: 16px; padding: 10px 0 10px 10px !important;" class="incident-col-16-padding"></td>
                    {/if}
                {/let}
                <td style="{body-section-table-td-style}" class="recommendation-col">
                  <a style="{body-section-table-td-a-style}" target="_blank" href="{environment.url}/insights/advisor/recommendations/{rec}?{query_params}">{action.context.advisor.resolved_recommendations.get(rec).rule_description}</a>
                </td>
                <td style="{body-section-table-td-style}">
                  {#switch action.context.advisor.resolved_recommendations.get(rec).total_risk}
                    {#case "1"}<img src="https://console.redhat.com/apps/frontend-assets/email-assets/img_low_v2.png" alt="Low severity" width="55" border="0">
                    {#case "2"}<img src="https://console.redhat.com/apps/frontend-assets/email-assets/img_moderate_v2.png" alt="Moderate severity" width="85" border="0">
                    {#case "3"}<img src="https://console.redhat.com/apps/frontend-assets/email-assets/img_important_v2.png" alt="Important severity" width="86" border="0">
                    {#case "4"}<img src="https://console.redhat.com/apps/frontend-assets/email-assets/img_critical_v2.png" alt="Critical severity" width="70" border="0">
                  {/switch}
                </td>
                <td style="{body-section-table-td-style}">{action.context.advisor.resolved_recommendations.get(rec).systems}</td>
              </tr>
            {/for}
            </tbody>
          </table>
      </td></tr></table>
      </td></tr>
      {#if action.context.advisor.deactivated_recommendations.orEmpty.size > 0}
        <tr><td style="line-height: 24px">&#xA0;</td></tr>
      {/if}
{/if}
{#if action.context.advisor.deactivated_recommendations.orEmpty.size > 0}
    <tr><td>
    <table style="border: solid 1px #b8bbbe; border-radius: 16px; padding: 0 8px 0 8px; width: 100%;"><tr><td>
        <table style="{body-section-table-style}">
           <thead>
            <tr>
              <th style="{body-section-table-th-style} width: 16px; padding: 10px 0 10px 10px !important;"></th>
              <th style="{body-section-table-th-style}" class="recommendation-col">Deactivated Recommendation{#if action.context.advisor.deactivated_recommendations.orEmpty.size > 1}s{/if}</th>
              <th style="{body-section-table-th-style}">Total Risk</th>
            </tr>
            </thead>
            <tbody style="{body-section-table-tbody-style}">
            {#for rec in action.context.advisor.deactivated_recommendations.keySet()}
              <tr>
                {#let isIncident = action.context.advisor.deactivated_recommendations.get(rec).has_incident.or("false")}
                    {#if isIncident && (true == isIncident || "true" == isIncident)}
                        <td style="{body-section-table-td-style} width: 16px; padding: 10px 0 10px 10px !important;">
                            <img src="https://console.redhat.com/apps/frontend-assets/email-assets/img_incident.png" title="Incident" alt="Incident" border="0" width="16" />
                        </td>
                    {#else}
                        <td style="{body-section-table-td-style} width: 16px; padding: 10px 0 10px 10px !important;" class="incident-col-16-padding"></td>
                    {/if}
                {/let}
                <td style="{body-section-table-td-style}" class="recommendation-col">
                    <a style="{body-section-table-td-a-style}" target="_blank" href="{environment.url}/insights/advisor/recommendations/{rec}?{query_params}">{action.context.advisor.deactivated_recommendations.get(rec).rule_description}</a>
                </td>
                <td style="{body-section-table-td-style}">
                  {#switch action.context.advisor.deactivated_recommendations.get(rec).total_risk}
                    {#case "1"}<img src="https://console.redhat.com/apps/frontend-assets/email-assets/img_low_v2.png" alt="Low severity" width="55" border="0">
                    {#case "2"}<img src="https://console.redhat.com/apps/frontend-assets/email-assets/img_moderate_v2.png" alt="Moderate severity" width="85" border="0">
                    {#case "3"}<img src="https://console.redhat.com/apps/frontend-assets/email-assets/img_important_v2.png" alt="Important severity" width="86" border="0">
                    {#case "4"}<img src="https://console.redhat.com/apps/frontend-assets/email-assets/img_critical_v2.png" alt="Critical severity" width="70" border="0">
                  {/switch}
                </td>
              </tr>
            {/for}
            </tbody>
        </table>
    </td></tr></table>
    </td></tr>
{/if}
</table>
{/content-body-section1}
{#content-button-href}{environment.url}/insights/advisor?{query_params}{/content-button-href}
{#content-button-service-name}Recommendations - Advisor{/content-button-service-name}
{/include}
